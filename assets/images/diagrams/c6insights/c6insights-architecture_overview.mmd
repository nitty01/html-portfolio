---
config:
  layout: elk
---
flowchart LR
    A["ğŸš— Vehicle Telemetry<br>Streaming Data"] --> B["ğŸ“¥ Apache Kafka"]
    B --> C["âš™ï¸ PySpark Processing<br>AWS EMR"]
    C --> D[("ğŸ’¾ S3 Data Lake")] & E[("ğŸ’¾ MongoDB<br>Raw Data")]
    
    F["ğŸ’° Fuel Price APIs"] --> G["âš¡ Lambda Function<br>Fuel Price Scraper"]
    G --> E
    
    H["ğŸŒ¬ï¸ AQI APIs"] --> I["ğŸ“¡ API Consumer"]
    I --> E
    
    J["ğŸ“Š Other Sources<br>Monthly Manual"] --> E
    K["ğŸ”‹ EV Incentives"] --> L[("ğŸ“š Chroma DB<br>Vector Store")]
    
    E --> M["âš™ï¸ Deep View Analytics<br>Master-Slave Architecture<br>Batch Processing"]
    L --> M
    M --> N[("ğŸ—„ï¸ PostgreSQL<br>Job Metadata")]
    M --> O["ğŸ“¨ RabbitMQ<br>Job Parallelization<br>Delay & DLQ"]
    
    P["ğŸ”„ Metadata Enhancement"] --> Q["ğŸŒ FastAPI"]
    Q --> O
    
    R["ğŸ‘¤ User UI"] --> S["ğŸŒ FastAPI<br>Simulation Endpoint"]
    S --> T["ğŸ¤– LLM Processing<br>Ollama + RAG + MCP"]
    T --> U["ğŸ“Š Vehicle Replacement<br>Fleet Roadmap<br>ROI & Carbon Savings"]
    U --> S
    S --> O
    O --> V["ğŸ“¢ Completion<br>Notification"]
    
    W["ğŸ³ Kubernetes<br>Pod-based Processing"] --> M
    X["â˜ï¸ AWS Cloud"] --> W
    
     A:::source
     F:::source
     H:::source
     J:::source
     K:::source
     B:::ingestion
     C:::processing
     G:::lambda
     I:::api
     M:::processing
     O:::messaging
     Q:::api
     S:::api
     T:::genai
     D:::storage
     E:::storage
     L:::storage
     N:::storage
     U:::output
     V:::output
     W:::infra
     X:::infra
     
    classDef source fill:#BBDEFB,stroke:#1565C0,stroke-width:2px,color:#0D1B2A
    classDef ingestion fill:#B2DFDB,stroke:#00695C,stroke-width:2px,color:#00332E
    classDef processing fill:#D1C4E9,stroke:#4527A0,stroke-width:2px,color:#1A093F
    classDef lambda fill:#FF9800,stroke:#F57C00,stroke-width:2px,color:#E65100
    classDef api fill:#81C784,stroke:#4CAF50,stroke-width:2px,color:#1B5E20
    classDef messaging fill:#BA68C8,stroke:#9C27B0,stroke-width:2px,color:#4A148C
    classDef storage fill:#FFE0B2,stroke:#EF6C00,stroke-width:2px,color:#4A2500
    classDef genai fill:#E1BEE7,stroke:#9C27B0,stroke-width:2px,color:#4A148C
    classDef output fill:#F8BBD0,stroke:#AD1457,stroke-width:2px,color:#4A0E2E
    classDef infra fill:#E1BEE7,stroke:#6A1B9A,stroke-width:2px,color:#2D0A3A
